# -*- coding: utf-8 -*-
"""Untitled24.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Zp2rxW6nvXDXW6WqcrSagxJgbU7G9YvH
"""

from google.colab import drive
drive.mount('/content/mydrive')

import pandas as pd

# Ù…Ø³ÛŒØ± ÙØ§ÛŒÙ„ CSV Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯
file_path = '//content//mydrive//MyDrive//Colab Notebooks//processed_data.csv'

try:
    # Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ CSV
    df = pd.read_csv(file_path)

    # Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ú¯Ù…Ø´Ø¯Ù‡ Ø¯Ø± Ù‡Ø± Ø³ØªÙˆÙ†
    missing_values = df.isnull().sum()

    # ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒÛŒ Ú©Ù‡ Ø¯Ø§Ø±Ø§ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ú¯Ù…Ø´Ø¯Ù‡ Ù‡Ø³ØªÙ†Ø¯
    missing_columns = missing_values[missing_values > 0]

    if not missing_columns.empty:
        print("âœ… Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø±Ø§ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ú¯Ù…Ø´Ø¯Ù‡:")
        print(missing_columns)
    else:
        print("ğŸ‰ Ù‡ÛŒÚ† Ø³ØªÙˆÙ†ÛŒ Ø¯Ø§Ø±Ø§ÛŒ Ù…Ù‚Ø¯Ø§Ø± Ú¯Ù…Ø´Ø¯Ù‡ Ù†ÛŒØ³Øª.")

except FileNotFoundError:
    print("âŒ ÙØ§ÛŒÙ„ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯. Ù…Ø³ÛŒØ± ØµØ­ÛŒØ­ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.")
except Exception as e:
    print(f"âš ï¸ Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯Ù‡ Ø§Ø³Øª: {e}")

import pandas as pd
import numpy as np
from sklearn.impute import SimpleImputer, KNNImputer
from sklearn.preprocessing import StandardScaler

# Ù…Ø³ÛŒØ± ÙØ§ÛŒÙ„ CSV Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ù‚Ø±Ø§Ø± Ø¯Ù‡ÛŒØ¯
file_path = '//content/mydrive//MyDrive//Colab Notebooks//processed_data.csv'
output_file = '//content/mydrive//MyDrive//Colab Notebooks//output.csv'
try:
    # Ø®ÙˆØ§Ù†Ø¯Ù† ÙØ§ÛŒÙ„ CSV
    df = pd.read_csv(file_path)

    # Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
    print("ğŸ“Š Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡:")
    print(df.head())

    # Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ú¯Ù…Ø´Ø¯Ù‡
    print("\nğŸ” Ø¨Ø±Ø±Ø³ÛŒ Ù…Ù‚Ø§Ø¯ÛŒØ± Ú¯Ù…Ø´Ø¯Ù‡:")
    missing_values = df.isnull().sum()
    print(missing_values[missing_values > 0])

    # 1ï¸âƒ£ Ø±ÙˆØ´ Ø¢Ù…Ø§Ø±ÛŒ: Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†
    print("\nğŸ”¹ ØªØ®Ù…ÛŒÙ† Ø¨Ø§ Ù…ÛŒØ§Ù†Ú¯ÛŒÙ†:")
    imputer_mean = SimpleImputer(strategy='mean')
    df_mean = pd.DataFrame(imputer_mean.fit_transform(df.select_dtypes(include=np.number)),
                            columns=df.select_dtypes(include=np.number).columns)
    print(df_mean.head())

    # 2ï¸âƒ£ Ø±ÙˆØ´ Ø¢Ù…Ø§Ø±ÛŒ: Ù…ÛŒØ§Ù†Ù‡
    print("\nğŸ”¹ ØªØ®Ù…ÛŒÙ† Ø¨Ø§ Ù…ÛŒØ§Ù†Ù‡:")
    imputer_median = SimpleImputer(strategy='median')
    df_median = pd.DataFrame(imputer_median.fit_transform(df.select_dtypes(include=np.number)),
                              columns=df.select_dtypes(include=np.number).columns)
    print(df_median.head())

    # 3ï¸âƒ£ Ø±ÙˆØ´ Ø¢Ù…Ø§Ø±ÛŒ: Ù…Ø¯ (Mode)
    print("\nğŸ”¹ ØªØ®Ù…ÛŒÙ† Ø¨Ø§ Ù…Ø¯:")
    imputer_mode = SimpleImputer(strategy='most_frequent')
    df_mode = pd.DataFrame(imputer_mode.fit_transform(df), columns=df.columns)
    print(df_mode.head())

    # 4ï¸âƒ£ Ø±ÙˆØ´ ÛŒØ§Ø¯Ú¯ÛŒØ±ÛŒ Ù…Ø§Ø´ÛŒÙ†: KNN Imputer
    print("\nğŸ”¹ ØªØ®Ù…ÛŒÙ† Ø¨Ø§ KNN Imputer:")

    # Ø§Ø¨ØªØ¯Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ù†Ø±Ù…Ø§Ù„â€ŒØ³Ø§Ø²ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… (Ø¶Ø±ÙˆØ±ÛŒ Ø¨Ø±Ø§ÛŒ KNN)
    scaler = StandardScaler()
    df_scaled = scaler.fit_transform(df.select_dtypes(include=np.number))

    # KNN Imputer
    imputer_knn = KNNImputer(n_neighbors=5)
    df_knn = pd.DataFrame(imputer_knn.fit_transform(df_scaled),
                           columns=df.select_dtypes(include=np.number).columns)

    # Ø¨Ø§Ø²Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ù‡ Ù…Ù‚ÛŒØ§Ø³ Ø§ØµÙ„ÛŒ
    df_knn_original = scaler.inverse_transform(df_knn)
    df_knn_original = pd.DataFrame(df_knn_original, columns=df.select_dtypes(include=np.number).columns)

    print(df_knn_original.head())

    df_knn_original.to_csv(output_file, index=False)
    print(f"\nâœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø± '{output_file}' Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù†Ø¯.")

except FileNotFoundError:
    print("âŒ ÙØ§ÛŒÙ„ Ù¾ÛŒØ¯Ø§ Ù†Ø´Ø¯. Ù…Ø³ÛŒØ± ØµØ­ÛŒØ­ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.")
except Exception as e:
    print(f"âš ï¸ Ø®Ø·Ø§ÛŒÛŒ Ø±Ø® Ø¯Ø§Ø¯Ù‡ Ø§Ø³Øª: {e}")